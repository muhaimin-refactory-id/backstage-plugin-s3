{"version":3,"file":"S3BucketViewer.esm.js","sources":["../../../src/components/S3BucketViewer/S3BucketViewer.tsx"],"sourcesContent":["import Alert from '@material-ui/lab/Alert';\nimport { BucketDetails } from '@spreadshirt/backstage-plugin-s3-viewer-common';\nimport { humanFileSize } from '../../utils';\nimport { Divider, Grid, Typography } from '@material-ui/core';\nimport { Progress, StructuredMetadataTable } from '@backstage/core-components';\n\ntype S3BucketViewProps = {\n  bucketInfo: BucketDetails | undefined;\n  loadingBucketInfo: boolean;\n  errorBucketInfo: Error | undefined;\n};\n\nexport const S3BucketViewer = ({\n  bucketInfo,\n  loadingBucketInfo,\n  errorBucketInfo,\n}: S3BucketViewProps) => {\n  if (loadingBucketInfo) {\n    return <Progress />;\n  } else if (errorBucketInfo) {\n    return <Alert severity=\"error\">{errorBucketInfo.message}</Alert>;\n  }\n\n  const parsePolicy = (policy: Record<string, any>) => {\n    const result: Record<string, any> = {};\n    if (policy.ID) {\n      result.ID = policy.ID;\n    }\n    if (policy.Status) {\n      result.Status = policy.Status;\n    }\n\n    if (policy.Expiration) {\n      result.Expiration = Object.entries(policy.Expiration)\n        .map(([key, value]) => `After ${value} ${key.toLowerCase()}`)\n        .join(', ');\n    }\n\n    const incompleteUpload = Object.values(\n      policy.AbortIncompleteMultipartUpload || {},\n    )\n      .map(value => `${value} days`)\n      .join('');\n\n    result.AbortIncompleteMultipartUpload = incompleteUpload || 'Not Set';\n\n    return result;\n  };\n\n  const getBucketInfoMetadata = (data: BucketDetails | undefined) => {\n    if (!data) {\n      return {};\n    }\n\n    const metadata: Record<string, any> = {\n      Endpoint: data.endpoint,\n      Owner: data.owner,\n      Objects: data.objects,\n      Size: `${humanFileSize(data.size)} (${data.size} bytes)`,\n    };\n\n    if (data.policy.length > 0) {\n      metadata.Lifecycle = parsePolicy(data.policy[0]);\n    }\n\n    return metadata;\n  };\n\n  return (\n    <>\n      <Typography variant=\"h5\">{bucketInfo?.bucket || ''}</Typography>\n      <Divider style={{ marginTop: 20, marginBottom: 20 }} />\n      <Grid container>\n        <Grid item xs={12}>\n          <StructuredMetadataTable\n            metadata={getBucketInfoMetadata(bucketInfo)}\n          />\n        </Grid>\n      </Grid>\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;;;AAYO,MAAM,iBAAiB,CAAC;AAAA,EAC7B,UAAA;AAAA,EACA,iBAAA;AAAA,EACA;AACF,CAAyB,KAAA;AACvB,EAAA,IAAI,iBAAmB,EAAA;AACrB,IAAA,2BAAQ,QAAS,EAAA,EAAA,CAAA;AAAA,aACR,eAAiB,EAAA;AAC1B,IAAA,uBAAQ,GAAA,CAAA,KAAA,EAAA,EAAM,QAAS,EAAA,OAAA,EAAS,0BAAgB,OAAQ,EAAA,CAAA;AAAA;AAG1D,EAAM,MAAA,WAAA,GAAc,CAAC,MAAgC,KAAA;AACnD,IAAA,MAAM,SAA8B,EAAC;AACrC,IAAA,IAAI,OAAO,EAAI,EAAA;AACb,MAAA,MAAA,CAAO,KAAK,MAAO,CAAA,EAAA;AAAA;AAErB,IAAA,IAAI,OAAO,MAAQ,EAAA;AACjB,MAAA,MAAA,CAAO,SAAS,MAAO,CAAA,MAAA;AAAA;AAGzB,IAAA,IAAI,OAAO,UAAY,EAAA;AACrB,MAAO,MAAA,CAAA,UAAA,GAAa,OAAO,OAAQ,CAAA,MAAA,CAAO,UAAU,CACjD,CAAA,GAAA,CAAI,CAAC,CAAC,GAAA,EAAK,KAAK,CAAM,KAAA,CAAA,MAAA,EAAS,KAAK,CAAI,CAAA,EAAA,GAAA,CAAI,aAAa,CAAA,CAAE,CAC3D,CAAA,IAAA,CAAK,IAAI,CAAA;AAAA;AAGd,IAAA,MAAM,mBAAmB,MAAO,CAAA,MAAA;AAAA,MAC9B,MAAA,CAAO,kCAAkC;AAAC,KAC5C,CACG,IAAI,CAAS,KAAA,KAAA,CAAA,EAAG,KAAK,CAAO,KAAA,CAAA,CAAA,CAC5B,KAAK,EAAE,CAAA;AAEV,IAAA,MAAA,CAAO,iCAAiC,gBAAoB,IAAA,SAAA;AAE5D,IAAO,OAAA,MAAA;AAAA,GACT;AAEA,EAAM,MAAA,qBAAA,GAAwB,CAAC,IAAoC,KAAA;AACjE,IAAA,IAAI,CAAC,IAAM,EAAA;AACT,MAAA,OAAO,EAAC;AAAA;AAGV,IAAA,MAAM,QAAgC,GAAA;AAAA,MACpC,UAAU,IAAK,CAAA,QAAA;AAAA,MACf,OAAO,IAAK,CAAA,KAAA;AAAA,MACZ,SAAS,IAAK,CAAA,OAAA;AAAA,MACd,IAAA,EAAM,GAAG,aAAc,CAAA,IAAA,CAAK,IAAI,CAAC,CAAA,EAAA,EAAK,KAAK,IAAI,CAAA,OAAA;AAAA,KACjD;AAEA,IAAI,IAAA,IAAA,CAAK,MAAO,CAAA,MAAA,GAAS,CAAG,EAAA;AAC1B,MAAA,QAAA,CAAS,SAAY,GAAA,WAAA,CAAY,IAAK,CAAA,MAAA,CAAO,CAAC,CAAC,CAAA;AAAA;AAGjD,IAAO,OAAA,QAAA;AAAA,GACT;AAEA,EAAA,uBAEI,IAAA,CAAA,QAAA,EAAA,EAAA,QAAA,EAAA;AAAA,oBAAA,GAAA,CAAC,UAAW,EAAA,EAAA,OAAA,EAAQ,IAAM,EAAA,QAAA,EAAA,UAAA,EAAY,UAAU,EAAG,EAAA,CAAA;AAAA,oBACnD,GAAA,CAAC,WAAQ,KAAO,EAAA,EAAE,WAAW,EAAI,EAAA,YAAA,EAAc,IAAM,EAAA,CAAA;AAAA,oBACrD,GAAA,CAAC,QAAK,SAAS,EAAA,IAAA,EACb,8BAAC,IAAK,EAAA,EAAA,IAAA,EAAI,IAAC,EAAA,EAAA,EAAI,EACb,EAAA,QAAA,kBAAA,GAAA;AAAA,MAAC,uBAAA;AAAA,MAAA;AAAA,QACC,QAAA,EAAU,sBAAsB,UAAU;AAAA;AAAA,OAE9C,CACF,EAAA;AAAA,GACF,EAAA,CAAA;AAEJ;;;;"}